<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>TapCoin</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
body {
    margin: 0;
    background: linear-gradient(180deg,#0e0e0e,#1c1c1c);
    color: white;
    font-family: Arial;
    height: 100vh;
}

#topbar {
    display: flex;
    justify-content: space-between;
    padding: 15px;
    align-items: center;
}

#balanceBox {
    background: #222;
    padding: 10px 18px;
    border-radius: 20px;
    font-size: 18px;
}

#sections {
    display: flex;
    justify-content: center;
    gap: 15px;
    margin-top: 10px;
}

.section {
    background: #222;
    padding: 10px 20px;
    border-radius: 12px;
    cursor: pointer;
}

#content {
    margin-top: 20px;
    text-align: center;
}

#coinBox {
    position: absolute;
    bottom: 60px;
    width: 100%;
    display: flex;
    justify-content: center;
}

#coin {
    width: 220px;
    height: 220px;
    border-radius: 50%;
    background: radial-gradient(circle, gold, orange);
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 26px;
    cursor: pointer;
    box-shadow: 0 0 30px gold;
}
</style>
</head>

<body>

<div id="topbar">
    <b>ğŸª™ TapCoin</b>
    <div id="balanceBox">0 ğŸª™</div>
</div>

<div id="sections">
    <div class="section" onclick="showMining()">â› Mining</div>
    <div class="section" onclick="showDaily()">ğŸ Daily</div>
    <div class="section" onclick="showBalance()">ğŸ’° Balance</div>
</div>

<div id="content"></div>

<div id="coinBox">
    <div id="coin">TAP</div>
</div>

<script>
const tg = window.Telegram.WebApp;
tg.expand();

const params = new URLSearchParams(window.location.search);
let balance = parseInt(params.get("balance")) || 0;
let lastMine = parseInt(params.get("last_mine")) || 0;

const MAX = 100;
const COOLDOWN = 1800;

const balanceBox = document.getElementById("balanceBox");
const content = document.getElementById("content");
const coin = document.getElementById("coin");

balanceBox.innerText = balance + " ğŸª™";

function showMining(){
    content.innerHTML = "<h2>â› Mining</h2><p>Tap qilib coin yigâ€˜ing</p>";
}

function showDaily(){
    content.innerHTML = `
        <h2>ğŸ Daily Bonus</h2>
        <button onclick="claimDaily()">Claim +10</button>
    `;
}

function showBalance(){
    content.innerHTML = `
        <h2>ğŸ’° Your Balance</h2>
        <h1>${balance} TapCoin</h1>
    `;
}

function claimDaily(){
    tg.sendData("daily");
    alert("ğŸ Bonus claim qilindi!");
}

function startTimer(seconds){
    let t = seconds;
    coin.innerText = formatTime(t);
    let timer = setInterval(()=>{
        t--;
        coin.innerText = formatTime(t);
        if(t<=0){
            clearInterval(timer);
            coin.innerText = "TAP";
        }
    },1000);
}

function formatTime(s){
    let m = Math.floor(s/60);
    let sec = s%60;
    return m+":"+(sec<10?"0"+sec:sec);
}

coin.onclick = ()=>{
    let now = Math.floor(Date.now()/1000);

    if(balance >= MAX){
        let left = COOLDOWN - (now - lastMine);
        if(left > 0){
            startTimer(left);
            return;
        }else{
            balance = 0;
        }
    }

    balance++;
    lastMine = now;
    balanceBox.innerText = balance + " ğŸª™";
    tg.sendData("tap");

    if(balance >= MAX){
        startTimer(COOLDOWN);
    }
};

showMining();
</script>

</body>
</html>
